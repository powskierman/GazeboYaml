# =============================================================================
# GAZEBO THERMOSTAT - TEXT SENSORS
# =============================================================================
# This file contains text sensors for WiFi info and time display
# =============================================================================

# -----------------------------------------------------------------------------
# TEXT SENSORS
# -----------------------------------------------------------------------------

text_sensor:
- platform: wifi_info
  ip_address:
    name: "WiFi IP"
    id: wifi_ip
    on_value:
      then:
        - lambda: |-
            ESP_LOGI("wifi", "WiFi IP: %s", x.c_str());
            char cmd[64];
            snprintf(cmd, sizeof(cmd), "zero.ip.txt=\"%s\"", x.c_str());
            id(nextion0).send_command(cmd);
            ESP_LOGI("wifi", "Sent IP to Nextion: %s", cmd);

- platform: template
  id: current_time_text
  name: "Current Time Text"
  internal: true
  update_interval: 60s
  lambda: |-
    auto now = id(sntp_time).now();
    char time_str[32];
    snprintf(time_str, sizeof(time_str), "%02d:%02d", now.hour, now.minute);
    ESP_LOGD("time", "Current time text: %s", time_str);
    return std::string(time_str);
  on_value:
    - lambda: |-
        ESP_LOGD("time", "Time text updated: %s", x.c_str());
        char cmd[64];
        snprintf(cmd, sizeof(cmd), "zero.time.txt=\"%s\"", x.c_str());
        id(nextion0).send_command(cmd);
        ESP_LOGD("time", "Sent time to Nextion: %s", cmd);

# Web Interface Date/Time Display
- platform: template
  id: current_date_time
  name: "Current Date & Time"
  update_interval: 10s
  lambda: |-
    auto now = id(sntp_time).now();
    if (!now.is_valid()) {
      return std::string("Time not synced");
    }
    char datetime_str[64];
    snprintf(datetime_str, sizeof(datetime_str), "%04d-%02d-%02d %02d:%02d:%02d", 
             now.year, now.month, now.day_of_month, 
             now.hour, now.minute, now.second);
    return std::string(datetime_str);
